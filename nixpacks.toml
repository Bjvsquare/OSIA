# Force Node 20 (required by Supabase, Vite 7, React Router 7, etc.)
[phases.setup]
nixPkgs = ["nodejs_20", "npm-10_x"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = ["npm install && npm run build && cd server && npm install && npm run build"]

[start]
cmd = "cd server && NODE_ENV=production node dist/server.js"
